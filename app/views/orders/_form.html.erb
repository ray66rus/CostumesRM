<%= form_for @order, :url => link do |f| %>

  <%= render :partial => 'common/errors', :locals => { :object => @order, :object_name => 'заказ' } %>

  <div class="client">
    <%= f.label :client %><br />
    <%= f.collection_select :client, Client.all, :id, :name %>
  </div>

  <div class="price">
    <%= f.label :price %><br />
    <%= f.number_field 'price', :min => 0 %>
  </div>
  
  <div class="payed_status">
    <%= f.label :payed_status %>&nbsp;
    <%= f.select 'payed_status', Order::PAYED_TO_PAYED_NAME_MAP.invert %>
  </div>
  
  <div class="costumes">
    <%= f.label :costumes %><br />
    <div id='costumes'>
      <% @order.costumes.each do |costume| %>
        <span>
          <%= costume.name %>
          <%= hidden_field_tag 'order[costumes]', costume.id, {:id => nil} %>
          <%= f.button 'Удалить', :type => 'button', :onclick => "OrdersHelper.RemoveCostume(event)" %><br />
        </span>
      <% end %>
    </div>
    <span>
    <% costume_selector_options = [] %>
    <% Costume.all.each do |costume| %>
      <% if costume.can_be_added_to_order? %>
        <% costume_selector_options.push("<option value='" + costume.id.to_s() + "' price='" + costume.price.to_s() + "'>" + costume.name + "</option>") %>
      <% end %>
    <% end %>
      <%= select_tag '', costume_selector_options.join().html_safe(), {:id => 'costume_selector', :name => nil} %>&nbsp;
      <%= f.button 'Добавить', :type => 'button', :onclick => "OrdersHelper.AddCostume(event)" %>
    </span>
  </div>
  
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>
